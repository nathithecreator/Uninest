<app-nav-dashboard></app-nav-dashboard>
<div class="main-dashboard-section">
  <div class="white-main-section">
    <div class="form-header">
      <button class="goback-btn" (click)="goBack()">
        <i class="bi bi-x-lg"></i>
      </button>
      <h1 class="property-title">Edit Property</h1>
      <div class="divider"></div>
      <p class="form-subtitle">Edit the details for your property listing.</p>
    </div>

    <form (ngSubmit)="updateProperty()" class="property-form">
      <div class="form-section">
        <div class="form-group">
          <label for="propertyName">Property Name</label>
          <input type="text" id="propertyName" 
                 [(ngModel)]="property.propertyName" 
                 name="propertyName"
                 class="form-control"
                 required>
        </div>

        <div class="form-group">
            <label for="unitNumber">Unit/Apartment Number</label>
            <input type="text" id="unitNumber" formControlName="unitNumber" class="form-control" 
                   placeholder="e.g., Unit 5">
          </div>

          <div class="form-group">
            <label for="suburb">Suburb *</label>
            <input type="text" id="suburb" formControlName="suburb" class="form-control" 
                   placeholder="e.g., Sunnyside">
            <div *ngIf="propertyForm.get('suburb')?.invalid && propertyForm.get('suburb')?.touched" 
                 class="error-message">
              Suburb is required
            </div>
          </div>

          <div class="form-group">
            <label for="city">City *</label>
            <input 
            type="text" 
            id="city" 
            [(ngModel)]="property.city" 
            class="form-control" 
            placeholder="e.g., Pretoria">
          
          </div>

          <div class="form-group">
            <label for="postalCode">Postal Code *</label>
            <input 
            type="text" 
            id="postalCode" 
            [(ngModel)]="property.postalCode" 
            class="form-control" 
            placeholder="e.g., 0001" 
            maxlength="4">
           
          </div>

          <div class="form-group">
          <label for="province">Province *</label>
          <select id="province" formControlName="province" class="form-control">
            <option value="" disabled selected>Select a Province</option>
            <option value="Eastern Cape">Eastern Cape</option>
            <option value="Free State">Free State</option>
            <option value="Gauteng">Gauteng</option>
            <option value="KwaZulu-Natal">KwaZulu-Natal</option>
            <option value="Limpopo">Limpopo</option>
            <option value="Mpumalanga">Mpumalanga</option>
            <option value="Northern Cape">Northern Cape</option>
            <option value="North West">North West</option>
            <option value="Western Cape">Western Cape</option>
          </select>
          
        </div>


         <div class="form-group">
            <label for="monthlyRent">Monthly Rent (R) *</label>
            <div class="input-with-icon">
              <span class="currency">R</span>
              <input type="number" 
              id="monthlyRent" 
               [(ngModel)]="property.rentAmount" 
              class="form-control" 
              placeholder="e.g., 5000">
            </div>
           
          </div>






        <div class="form-group">
          <label for="address">Street Address</label>
          <input type="text" id="address" 
                 [(ngModel)]="property.streetAddress" 
                 name="address"
                 class="form-control"
                 required>
        </div>



        <div class="form-group">
          <label for="propertyType">Property Type</label>
          <select id="propertyType" 
                  [(ngModel)]="property.type" 
                  name="propertyType"
                  class="form-control"
                  required>
            <option value="">Select property type</option>
            <option value="apartment">Apartment</option>
            <option value="house">House</option>
            <option value="townhouse">Townhouse</option>
            <option value="studio">Studio</option>
          </select>
        </div>

        <div class="form-group">
          <label for="monthlyRent">Monthly Rent (R)</label>
          <input type="number" id="monthlyRent" 
                 [(ngModel)]="property.rentAmount" 
                 name="monthlyRent"
                 class="form-control"
                 (input)="calculateFee()"
                 required>
          <span class="fee-display">Estimated Listing Fee: R {{listingFee | number:'1.2-2'}} (5% of monthly rent)</span>
        </div>

        <div class="form-group">
          <label for="bedrooms">Number of Bedrooms</label>
          <input type="number" id="bedrooms" 
                 [(ngModel)]="property.bedrooms" 
                 name="bedrooms"
                 class="form-control" 
                 placeholder="e.g., Studio (0), 1, 2 etc"
                 required>
        </div>

        <div class="form-group">
          <label for="description">Description</label>
          <textarea id="description" 
                    [(ngModel)]="property.description" 
                    name="description"
                    class="form-control" 
                    rows="4"
                    placeholder="Provide a detailed description of your property"
                    required></textarea>
        </div>
      </div>

      <div class="form-section">
        <div class="form-group">
          <label>Main Property Image</label>
          
          <div class="existing-image-container" *ngIf="imagePreview && !selectedFile">
            <img [src]="imagePreview" class="existing-image" style="width: 400px; height: auto;">
            <button type="button" class="remove-existing-btn" (click)="imagePreview = null">
              <i class="bi bi-x"></i> Remove
            </button>
          </div>
          
          <div class="file-upload-container" [class.has-file]="selectedFile">
            <input type="file" id="propertyImage" 
                   (change)="onFileSelected($event)" 
                   accept="image/*" 
                   style="display: none;">
            <label for="propertyImage" class="file-upload-btn" style="color: white;">
              <i class="bi bi-cloud-arrow-up"></i> Choose Image
            </label>
            <div class="file-names" *ngIf="selectedFile">
              {{selectedFile.name | slice:0:25 }}
            </div>
            <div class="file-names" *ngIf="!selectedFile && !imagePreview">
              No image chosen
            </div>
          </div>
          
          <div class="file-requirements">
            <i class="bi bi-info-circle"></i> Main property image (JPEG or PNG)
          </div>
        </div>
      </div>

      <div class="form-actions">
        <button type="button" class="cancel-btn" (click)="goBack()">Cancel</button>
        <button type="submit" class="submit-btn" [disabled]="!imagePreview">
          Save Changes
        </button>
      </div>
    </form>
  </div>
</div>